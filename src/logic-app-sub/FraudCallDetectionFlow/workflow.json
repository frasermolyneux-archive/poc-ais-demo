{
    "definition": {
        "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
        "actions": {
            "Initialize_variable": {
                "type": "InitializeVariable",
                "inputs": {
                    "variables": [
                        {
                            "name": "MyVariable",
                            "type": "boolean",
                            "value": true
                        }
                    ]
                },
                "runAfter": {
                    "Parse_JSON": [
                        "SUCCEEDED"
                    ]
                },
                "trackedProperties": {
                    "CalledIMSI": "@triggerBody()['userProperties']['calledIMSI']",
                    "CallingIMSI": "@triggerBody()['userProperties']['callingIMSI']",
                    "InterfaceId": "ID_FraudCallDetection",
                    "MSRN": "@triggerBody()['userProperties']['msrn']",
                    "MessageId": "@triggerBody()['userProperties']['messageId']"
                }
            },
            "Parse_JSON": {
                "type": "ParseJson",
                "inputs": {
                    "content": "@triggerBody()?['contentData']",
                    "schema": {
                        "properties": {
                            "CallPeriod": {
                                "type": "integer"
                            },
                            "CalledCellID": {},
                            "CalledIMSI": {
                                "type": "string"
                            },
                            "CalledNum": {},
                            "CalledNum2": {},
                            "CallingCellID": {},
                            "CallingIMSI": {
                                "type": "string"
                            },
                            "CallingNum": {},
                            "DateS": {
                                "type": "string"
                            },
                            "EventEnqueuedUtcTime": {
                                "type": "string"
                            },
                            "EventProcessedUtcTime": {
                                "type": "string"
                            },
                            "FCIFlag": {},
                            "FileNum": {
                                "type": "string"
                            },
                            "IncomingTrunk": {},
                            "MSRN": {
                                "type": "string"
                            },
                            "OutgoingTrunk": {
                                "type": "string"
                            },
                            "PartitionId": {
                                "type": "integer"
                            },
                            "RecordType": {
                                "type": "string"
                            },
                            "ServiceType": {
                                "type": "string"
                            },
                            "SwitchNum": {
                                "type": "string"
                            },
                            "SystemIdentity": {
                                "type": "string"
                            },
                            "TimeS": {},
                            "TimeType": {
                                "type": "integer"
                            },
                            "Transfer": {
                                "type": "integer"
                            },
                            "callrecTime": {
                                "type": "string"
                            }
                        },
                        "type": "object"
                    }
                },
                "runAfter": {}
            },
            "Call_an_Azure_function": {
                "type": "Function",
                "inputs": {
                    "method": "POST",
                    "body": "@body('Parse_JSON')",
                    "function": {
                        "connectionName": "functionAppJob"
                    }
                },
                "runAfter": {
                    "Initialize_variable": [
                        "SUCCEEDED"
                    ]
                }
            },
            "HTTP": {
                "type": "Http",
                "inputs": {
                    "uri": "https://www.google.com",
                    "method": "GET"
                },
                "runAfter": {
                    "Call_an_Azure_function": [
                        "SUCCEEDED"
                    ]
                },
                "runtimeConfiguration": {
                    "contentTransfer": {
                        "transferMode": "Chunked"
                    }
                },
                "trackedProperties": {
                    "CalledIMSI": "@triggerBody()['userProperties']['calledIMSI']",
                    "CallingIMSI": "@triggerBody()['userProperties']['callingIMSI']",
                    "InterfaceId": "ID_FraudCallDetection",
                    "MSRN": "@triggerBody()['userProperties']['msrn']",
                    "MessageId": "@triggerBody()['userProperties']['messageId']"
                }
            }
        },
        "contentVersion": "1.0.0.0",
        "outputs": {},
        "triggers": {
            "When_messages_are_available_in_a_queue": {
                "type": "ServiceProvider",
                "inputs": {
                    "parameters": {
                        "queueName": "fraud_call_detections",
                        "isSessionsEnabled": false
                    },
                    "serviceProviderConfiguration": {
                        "connectionName": "serviceBus",
                        "operationId": "receiveQueueMessages",
                        "serviceProviderId": "/serviceProviders/serviceBus"
                    }
                },
                "splitOn": "@triggerOutputs()?['body']",
                "splitOnConfiguration": {
                    "correlation": {
                        "clientTrackingId": "@triggerBody()['userProperties']['messageId']"
                    }
                }
            }
        },
        "parameters": {}
    },
    "connectionReferences": {
        "serviceBus": {
            "connection": {
                "id": "/serviceProviders/serviceBus/connections/serviceBus"
            },
            "connectionName": "servicebus-connection",
            "api": {
                "id": "/serviceProviders/serviceBus"
            }
        },
        "azureFunctionOperation": {
            "connection": {
                "id": "/connectionProviders/azureFunctionOperation/connections/azureFunctionOperation"
            },
            "connectionName": "azureFunctionOperation",
            "api": {
                "id": "/connectionProviders/azureFunctionOperation"
            }
        }
    },
    "parameters": {}
}